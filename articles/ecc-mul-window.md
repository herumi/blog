---
title: "楕円曲線暗号のための数学4（ウィンドウ法）"
emoji: "🧮"
type: "tech"
topics: ["楕円曲線暗号", "ウィンドウ法"]
published: false
---
## 初めに
[楕円曲線暗号のための数学2（バイナリ法によるスカラー倍算）](http://localhost:8000/articles/ecc-binary-method)では楕円曲線の点のスカラー倍算をバイナリ法を用いた方法を紹介しました。今回はより高速に計算できるウィンドウ法を紹介します。

## 記号の復習
楕円曲線の点からなる素数位数 $r$ の加法群を $G$ とします。
点 $P \in G$ の2倍算を $\text{dbl}(P)$, $P, Q \in G$ の和を $\text{add}(P, Q)$ とします。

## バイナリ法の復習
$n>0$ を整数として、Ec を楕円曲線の点を表すクラスとして Python で記述すると次のようになりました。

```python
def mul(P : Ec, n : int):
  bs = bin(n)[2:]
  Q = Ec() # zero
  for b in bs: # 上位ビットから順次計算
    Q = dbl(Q)
    if b == '1':
      Q = add(Q, P)
  return Q
```
$n$ を2進数展開して、その上位ビットから $Q$ を2倍しながら 1 が立っているときに $P$ を足していくのでした。

## ウィンドウ法
ウィンドウ法は $n$ を1ビットずつ見ていくのではなく、$w$ ビットずつ区切って見ていくやり方です。
たとえば $w=3$ のとき、$n$ を2進数展開して $w$ ビットずつ区切ると0以上7以下の値になります。
$0, P, 2 P, \dots, 7 P$ を事前に計算しておき、$Q$ を2倍しながら途中でその値を足せばよいのです。

*ウィンドウ法*
![ウィンドウ法](/images/window-method.png)

