# AVX10メモ

## AVX10テクニカルペーパーメモ
- [Intel Advanced Vector Extensions 10 Technical Paper](https://cdrdv2.intel.com/v1/dl/getContent/784267)
- AVX-512の全ての機能を含む
- 最大256ビットSIMDレジスタを持つプロセッサにも512ビットSIMDレジスタを持つプロセッサにも対応
- CPUIDのチェックすべきフラグの数を減らす仕組み
- 将来のPコアとEコアの両方で動作

AVX10の収束バージョン(converged version)は
- (256ビット長に制約された)AVX-512の全ての機能を持つ
  - AVX10自体は512ビット長を利用可能
- 8個のマスクレジスタ
- 組み込み丸め

## 機能の列挙方法
- 既存のCPUは新しい命令ごとに新しいCPUIDフラグが追加されてチェックがとても大変
- 新しいバージョニングアプローチをとる
  - AVX10をサポートしていることを示すフラグ
    - AVX10をサポートしていればAVX/AVX2もサポートしている
  - AVX10のバージョン番号
    - 単調増加する
    - バージョンが大きければそれまでの機能が全て使えることを保証する
    - スカラー命令はいつでもサポートする
  - 128/256/512のビット長
    - 128/256は全てのプロセッサでサポート
    - 512はPコアでサポート
- AVX-512はAVX10が導入された時点でもう変更されない
- 新しい命令はAVX10として導入される

## パフォーマンス
- AVX2向けのアプリケーションはAVX10で再コンパイルすればパフォーマンスが向上するはず
- ベクターレジスタのプレッシャー(レジスタが沢山いる)AVX2アプリケーション
  - 16個レジスタを余計に使えるようになる
  - 新しい命令を利用できる
ようは新しい命令群で書き直せば速くなるということだろう

## 可用性
- AVX10.1
  - 128/256ビット FP/INT(512ビットはオプション)
  - 32個のSIMDレジスタ
  - 8個のマスクレジスタ
  - 512(?)ビット埋め込み丸め
  - 埋め込みブロードキャスト
  - Pコアのみ
- AVX10.2
  - 128/256ビット FP/INT(512ビットはオプション)
  - 32個のSIMDレジスタ
  - 8個のマスクレジスタ
  - 256/512(?)ビット埋め込み丸め
  - 埋め込みブロードキャスト
  - Pコア・Eコアサポート

# AVX10アーキテクチャ仕様
- [The Converged Vector ISA:Intel Advanced Vector Extensions 10](https://cdrdv2.intel.com/v1/dl/getContent/784343)
- AVX10は将来のPコアとEコアを含む全てのプロセッサでサポート
- Granite Rapidsで対応している全てのAVX-512をサポート
- AVX10の収束バージョン
  - 最大256ビットSIMDレジスタ
  - 32ビットのマスクレジスタ
  - YMMレジスタに対する組み込み丸め/SAE制御
- AVX10/512のPコアでは
  - 最大512ビットのSIMDレジスタ
  - 64ビットのマスクレジスタ
- AVX10/256仮想マシンを作成するVMX機能
- AVX10/128のサポート予定はない
- AVX10.1は128, 256ビットのAVX-512命令のみサポートする
- 512ビットはGranite Rapids上でpre-enableされる

機能|AVX-512|AVX10.1/256|AVX10.2/256|AVX10.1/512|AVX10.2/512
-|-|-|-|-|-
XMM|yes|yes|yes|yes|yes
YMM|yes|yes|yes|yes|yes
ZMM|yes|no|no|yes|yes
YMM埋め込み丸め|no|no|yes|no|yes
ZMM埋め込み丸め|yes|no|no|yes|yes
