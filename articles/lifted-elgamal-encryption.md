---
title: "楕円lifted ElGamal暗号の加法準同型性"
emoji: "🧮"
type: "tech"
topics: ["liftedElGamal暗号", "楕円曲線", "加法準同型暗号"]
published: false
---
## 初めに
前回、楕円曲線を使った公開鍵暗号[楕円ElGamal暗号](https://zenn.dev/herumi/articles/elgamal-encryption)を紹介しました。
この方式は暗号化したい数値をそのまま使えず、楕円曲線の点に埋め込まなければなりませんでした。lifted ElGamal暗号はその問題を改善する方法の一つです。
そのやり方を紹介し、lifted ElGamal暗号が持つ加法性について紹介します。

## 楕円ElGamal暗号の復習
$P$を楕円曲線の点、$G$を$P$を生成元とする位数$r$の巡回群とします。$G=\Set{0, P, 2P, \dots, (r-1)P}.$

$0$以上$r$未満の整数の集合$[0, r)$からランダムに整数$s$を一つとり、秘密鍵とします。$Q:=sP$が公開鍵です。
$G$の要素$M$を暗号化するには、$t ← [0, r)$をランダムにとり、公開鍵$Q$を使って$Enc(Q, M):=(M+tQ,tP)$とします。
暗号文$c:=(S,T)$に対して秘密鍵$s$を使って$Dec(s,c):=S-sT$で復号します。

## 楕円lifted ElGamal暗号
説明の前に一つ記号を導入します。$G$の点$xP$が与えられたときに$x \in [0, r)$を求める操作を$DLP(P, xP)=x$と書くことにします。DLPは離散対数問題を解く操作です。

楕円lifted ElGamal暗号の鍵生成はElGamal暗号と同じです。
$s← [0, r)$が秘密鍵で$Q:=sP$が公開鍵。

整数$m$を暗号化するには、$M:=mP$として楕円曲線の点を作り、それをElGamal暗号化します。
つまり、$t ← [0, r)$をランダムにとり

$$
Enc(Q, m):=(mP+tQ, tP).
$$

暗号文$c=(S, T)$の復号は$dec(s, c):=S-sT$したあと、結果を$P$に関してDLPで解きます。

$$
Dec(s, c):=DLP(P, dec(s, c)).
$$

## 楕円lifted ElGamal暗号の妥当性
$m$を暗号化して作った暗号文$c$を復号したら元に戻ることを確認します。
$M:=mP$をElGamal暗号で暗号化して、復号するので$M$に戻ります。最後に$DLP(P, M)=DLP(P, mP)=m$とDLPを解いて元に戻ります。

暗号の安全性のためにDLP困難な群を使っているのに、復号時にDLPを解くのはナンセンスに思います。それは当然の考えなのですが、$m$が32ビット程度の整数値なら力業でDLPを解いても実用的な速度が得られます。力業の実装例はまたの機会に紹介します。
楕円lifted ElGamal暗号は平文の範囲が狭められる、復号時に小さなDLPを解かなければならないという制約があるのですが、その代わりに次節で紹介する興味深い性質を持っています。
