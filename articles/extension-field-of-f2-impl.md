---
title: "暗号で使われる標数2の体の実装"
emoji: "🧮"
type: "tech"
topics: ["F2", "AES", "GCM", "AVX512"]
published: false
---
## 初めに

今回は標数2の体の基本的な実装方法をいくつか紹介します。

## $𝔽_{2^8}$ の実装
### 多項式のビット表現
拡大体の定義が分かったので実装について8次拡大体 $K=𝔽_{2^8}$ について解説します。
$𝔽_2$ の要素は1ビットで表せるので8次拡大体なら8ビットで多項式を表現できます。8ビット整数aのiビット目$a_i$が7次多項式のi次の係数としましょう（i=0, ..., 7）。
たとえばa = 0b01101101なら対応する多項式は$X^6 + X^5 + X^3 + X^2 + 1$です。

a = 0b01101101に対応する多項式
ビット位置|7|6|5|4|3|2|1|0
-|-|-|-|-|-|-|-|-
$a_i$|0|1|1|0|1|1|0|1
多項式|0|$X^6$|$X^5$|0|$X^3$|$X^2$|0|1

### 多項式の加算
二つの多項式aとbの加算を考えます。aとbは8ビット整数で、多項式の加算は同じ次数の係数を足したものです。
$$a+b=(a_7 X^7 + \cdots + a_0)+(b_7 X^7 + \cdots + b_0) = (a_7 + b_7)X^7 + \cdots + (a_0+b_0).$$
各係数は $𝔽_2$ の要素なので加算は排他的論理和になるのでした。それをビットごとにすればよいので結局整数として排他的論理和を取ればよいです。引き算もaddと同じですね。

```c
typedef uint8_t K;
K add(K a, K b)
{
  return a ^ b;
}
K sub(K a, K b)
{
  return add(a, b);
}
```

### 多項式の乗算
